<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-8</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>stage = 0;
editstring = noone;

num_font = font_add_sprite(spr_title_numbers,ord("0"),true,2);

//get file name
if(file_exists("file1.dat")) {

var tempdat = ds_map_secure_load("file1.dat");
if !(ds_exists(tempdat,ds_type_map)) {
file_delete("file1.dat");
} else {
fname1 = string(ds_map_find_value(tempdat,"name"));
fscore1 = ""
ds_map_destroy(tempdat);
}

} else {
fname1 = "Empty Game";
fscore1 = ""
}
if(file_exists("file2.dat")) {

var tempdat = ds_map_secure_load("file2.dat");
if !(ds_exists(tempdat,ds_type_map)) {
file_delete("file2.dat");
} else {
fname2 = string(ds_map_find_value(tempdat,"name"));
fscore2 = ""
ds_map_destroy(tempdat);
}

} else {
fname2 = "Empty Game";
fscore2 = ""
}
if(file_exists("file3.dat")) {

var tempdat = ds_map_secure_load("file3.dat");
if !(ds_exists(tempdat,ds_type_map)) {
file_delete("file3.dat");
} else {
fname3 = string(ds_map_find_value(tempdat,"name"));
fscore3 = ""
ds_map_destroy(tempdat);
}

} else {
fname3 = "Empty Game";
fscore3 = ""
}
//end file name


panic1 = false;
panic2 = false;
panic3 = false;

fileselected = 0;
f1y = 0;
f2y = 0;
f3y = 0;
f1t = 0;
f2t = 0;
f3t = 0;
f1c = 0;
f2c = 0;
f3c = 0;

ux = 0;
uy = 0;
flip = 1;

cango = true;
away = 0;
num = 0;

num2 = 0;
up = 0;

new_file_str = ""

select_x = 0;
select_y = 0;
row = 0;
coloumn = 0; 

optionsup = 0;
optionsin = 0;
opselected = 0;

test = "";
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///get save data from files!

//get file name
if(file_exists("file1.dat")) {

var tempdat = ds_map_secure_load("file1.dat");
if !(ds_exists(tempdat,ds_type_map)) {
file_delete("file1.dat");
} else {
fname1 = string(ds_map_find_value(tempdat,"name"));
fscore1 = scr_convert_5_digit( ds_map_find_value(tempdat,"pieces") )
panic1 = ds_map_find_value(tempdat,"panicsv");
ds_map_destroy(tempdat);
}


} else {
fname1 = "Empty Game";
fscore1 = ""
panic1 = false;
}

if(file_exists("file2.dat")) {

var tempdat = ds_map_secure_load("file2.dat");
if !(ds_exists(tempdat,ds_type_map)) {
file_delete("file2.dat");
} else {
fname2 = string(ds_map_find_value(tempdat,"name"));
fscore2 = scr_convert_5_digit( ds_map_find_value(tempdat,"pieces") )
panic2 = ds_map_find_value(tempdat,"panicsv");
ds_map_destroy(tempdat);
}

} else {
fname2 = "Empty Game";
fscore2 = "";
panic2 = false;
}
if(file_exists("file3.dat")) {

var tempdat = ds_map_secure_load("file3.dat");
if !(ds_exists(tempdat,ds_type_map)) {
file_delete("file3.dat");
} else {
fname3 = string(ds_map_find_value(tempdat,"name"));
fscore3 = scr_convert_5_digit( ds_map_find_value(tempdat,"pieces") )
panic3 = ds_map_find_value(tempdat,"panicsv");
ds_map_destroy(tempdat);
}

} else {
fname3 = "Empty Game";
fscore3 = ""
panic3 = false;
}
//end file name
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>shader_reset();
d3d_set_projection_ortho(0, 0, global.gamewidth, global.gameheight, 0);

if(stage = 1 &amp;&amp; num2 = 0) {
num += 1
} else if(num2 = 0) {
num -= 1
}

num = clamp(num,0,60);
away = ease_inout_cubic(0,320,num/60);

draw_set_valign(fa_top);
draw_set_font(fnt_petscop);



var opos=obj_logo;
var lx = 320+160+opos.nx
d3d_set_culling(false);

if(opos.nx = 0) fileselected = 0

if(global.action_key) {
flip = -1 
} else {
flip = 1;
}

if(num == 0) {
draw_sprite_ext(spr_files,0,lx-136-away,20+f1y,1,1,0,c_white,1);
draw_sprite_ext(spr_files,0,lx+134+away,57+f2y,-1,1,0,c_white,1);
draw_sprite_ext(spr_files,0,lx-136-away,94+f3y,1,1,0,c_white,1);
draw_sprite_ext(spr_talk_buttons,0,lx-110-away,200,1,1,0,c_white,1);
draw_text_colour(lx-45-away,204,"Select File",c_black,c_black,c_black,c_black,1);
draw_sprite_ext(spr_talk_buttons,1,lx+19+away,200,1,1,0,c_white,1);
draw_text_colour(lx+75+away,204,"Go Back",c_black,c_black,c_black,c_black,1);
} else {
    if(fileselected = 0) {
    draw_sprite_ext(spr_files,num/8,lx-136-away,20+f1y,1,1,0,c_white,1);
    draw_sprite_ext(spr_talk_buttons_pressed,0,lx-110,200+away,1,1,0,c_white,1);
    draw_text_colour(lx-45,204+away,"Select File",c_black,c_black,c_black,c_black,1);
    draw_sprite_ext(spr_talk_buttons,1,lx+19,200+away,1,1,0,c_white,1);
    draw_text_colour(lx+75,204+away,"Go Back",c_black,c_black,c_black,c_black,1);
    } else {
    draw_sprite_ext(spr_files,0,lx-136-away,20+f1y,1,1,0,c_white,1);
    }
    if(fileselected = 1) {
    draw_sprite_ext(spr_files,num/8,lx+134+away,57+f2y,-1,1,0,c_white,1);
    draw_sprite_ext(spr_talk_buttons_pressed,0,lx-110,200+away,1,1,0,c_white,1);
    draw_text_colour(lx-45,204+away,"Select File",c_black,c_black,c_black,c_black,1);
    draw_sprite_ext(spr_talk_buttons,1,lx+19,200+away,1,1,0,c_white,1);
    draw_text_colour(lx+75,204+away,"Go Back",c_black,c_black,c_black,c_black,1);
    } else {
    draw_sprite_ext(spr_files,0,lx+134+away,57+f2y,-1,1,0,c_white,1);
    }
    if(fileselected = 2) {
    draw_sprite_ext(spr_files,num/8,lx-136-away,94+f3y,1,1,0,c_white,1);
    draw_sprite_ext(spr_talk_buttons_pressed,0,lx-110,200+away,1,1,0,c_white,1);
    draw_text_colour(lx-45,204+away,"Select File",c_black,c_black,c_black,c_black,1);
    draw_sprite_ext(spr_talk_buttons,1,lx+19,200+away,1,1,0,c_white,1);
    draw_text_colour(lx+75,204+away,"Go Back",c_black,c_black,c_black,c_black,1);
    } else {
    draw_sprite_ext(spr_files,0,lx-136-away,94+f3y,1,1,0,c_white,1);
    }
    
}
//score
draw_set_font(num_font);
draw_set_halign(fa_left);
draw_text_colour(lx+21-away,f1y+66,fscore1,c_black,c_black,c_black,c_black,1);
draw_set_halign(fa_right);
draw_text_colour(lx-4+away,f2y+103,fscore2,c_black,c_black,c_black,c_black,1);
draw_set_halign(fa_left);
draw_text_colour(lx+21-away,f3y+140,fscore3,c_black,c_black,c_black,c_black,1);

if(fscore1 != "") draw_sprite(spr_title_counter,0,lx+3-away,f1y+61)
if(fscore2 != "") draw_sprite(spr_title_counter,0,lx-62+away,f2y+98)
if(fscore3 != "") draw_sprite(spr_title_counter,0,lx+3-away,f3y+135)
//names
draw_set_font(fnt_petscop);
draw_set_color(c_black)

draw_set_halign(fa_left);
draw_text_colour(lx-74-away,f1y+65,fname1,c_black,c_black,c_black,c_black,1);

draw_set_halign(fa_right);
draw_text_colour(lx+71+away,f2y+102,fname2,c_black,c_black,c_black,c_black,1);

draw_set_halign(fa_left);
draw_text_colour(lx-74-away,f3y+139,fname3,c_black,c_black,c_black,c_black,1);

draw_set_color(c_white)
draw_set_halign(fa_left);
image_index += 1/12
image_speed = 0

if(fileselected = 0) draw_sprite(spr_player_move_down,image_index,lx-136-away,f1y+17)
if(fileselected = 1) draw_sprite(spr_player_move_down,image_index,lx+70+away,f2y+54)
if(fileselected = 2) draw_sprite(spr_player_move_down,image_index,lx-136-away,f3y+91)

if(panic1) draw_sprite_ext(spr_panic_sv,0,lx-76-away,60+f1y,1,1,0,c_white,1);
if(panic2) draw_sprite_ext(spr_panic_sv,0,lx-65+away,97+f2y,1,1,0,c_white,1);
if(panic3) draw_sprite_ext(spr_panic_sv,0,lx-76-away,134+f3y,1,1,0,c_white,1);

//draw_sprite(spr_player_move_down,global.t/10,lx+round(ux),round(uy))

//draw_sprite_ext(spr_panic_sv,0,lx+ux,uy,1,1,0,c_white,1);
//file1
if(f1c = 1) {
    f1t++;
    f1y = -abs(scr_sine_so(2.5,10,clamp(f1t,0,24)));
    if(f1t &gt;= 24) {
        f1t = 0;
        f1c = 0;
    }
} else if(f1c = 2) {
    f1t++;
    f1y = -abs(scr_sine_so(2.5,10,clamp(f1t,0,24)));
    if(f1t &gt;= 24) {
        f1t = 0;
        f1c = 0;
    }
}

//file2
if(f2c = 1) {
    f2t++;
    f2y = -abs(scr_sine_so(2.5,10,clamp(f2t,0,24)));
    if(f2t &gt;= 24) {
        f2t = 0;
        f2c = 0;
    }
} else if(f2c = 2) {
    f2t++;
    f2y = abs(scr_sine_so(2.5,10,clamp(f2t,0,24)));
    if(f2t &gt;= 24) {
        f2t = 0;
        f2c = 0;
    }
}

//file3
if(f3c = 2) {
    f3t++;
    f3y = abs(scr_sine_so(2.5,10,clamp(f3t,0,24)));
    if(f3t &gt;= 24) {
        f3t = 0;
        f3c = 0;
    }
} else {
if(f3c = 1) {
    f3t++;
    f3y = abs(scr_sine_so(2.5,10,clamp(f3t,0,24)));
    if(f3t &gt;= 24) {
        f3t = 0;
        f3c = 0;
    }
}
}

//stage0/////////////////////////////////////////////////////
if(stage = 0 &amp;&amp; opos.nx = -320 &amp;&amp; away = 0) {

if(global.up_pressed) {
fileselected--;

if(fileselected == 0) {
    f1c = 1;
    audio_play_sound(snd_switch_selected_file,10,false);
}
if(fileselected == 1) {
    f2c = 1;
    audio_play_sound(snd_switch_selected_file,10,false);
}
if(fileselected == 2) {
    f3c = 1;
    audio_play_sound(snd_switch_selected_file,10,false);
}
}
if(global.down_pressed) {
fileselected++;

if(fileselected == 0) {
    f1c = 2;
    audio_play_sound(snd_switch_selected_file,10,false);
}
if(fileselected == 1) {
    f2c = 2;
    audio_play_sound(snd_switch_selected_file,10,false);
}
if(fileselected == 2) {
    f3c = 2;
    audio_play_sound(snd_switch_selected_file,10,false);
}
}

if(global.action_pressed) {

    if(fileselected == 0 &amp;&amp; fname1 = "Empty Game") {
    stage = 1;
    audio_play_sound(snd_file_create,10,false);
    } else if(fileselected == 0) {
    stage = 2;
    }
    if(fileselected == 1 &amp;&amp; fname2 = "Empty Game") {
    stage = 1;
    audio_play_sound(snd_file_create,10,false);
    } else if(fileselected == 1) {
    stage = 2;
    }
    if(fileselected == 2 &amp;&amp; fname3 = "Empty Game") {
    stage = 1;
    audio_play_sound(snd_file_create,10,false);
    } else if(fileselected == 2) {
    stage = 2;
    }

}

}
//stage0/////////////////////////////////////////////////////

//stage1/////////////////////////////////////////////////////
if(stage = 1 &amp;&amp; num = 60) {
    num2++;
    
    if(row &gt;= 13) {
    row = 0;
    coloumn ++;
    select_y = coloumn*20
    select_x = -1*16
    }
    if(row &lt;= -1) {
    row = 12;
    coloumn --;
    select_y = coloumn*20
    select_x = 13*16
    }
    
    if(coloumn &gt;= 6) {
    coloumn = 0;
    select_y = (coloumn*20)-20
    select_x = row*16
    }
    if(coloumn &lt;= -1) {
    coloumn = 5;
    select_y = (coloumn*20)+20
    select_x = row*16
    }
    
    select_x += ((row*16 -select_x) / 3);
    select_y += ((coloumn*20 -select_y) / 3);
    
    if(global.up_pressed) {
    coloumn-= 1
    audio_play_sound(snd_keyboard_move_title,10,false);
    }
    if(global.down_pressed) {
    coloumn+= 1
    audio_play_sound(snd_keyboard_move_title,10,false);
    }
    if(global.left_pressed) {
    row-= 1
    audio_play_sound(snd_keyboard_move_title,10,false);
    }
    if(global.right_pressed) {
    row+= 1
    audio_play_sound(snd_keyboard_move_title,10,false);
    }
    
    if(global.action_pressed &amp;&amp; keyboard_get_key(row,coloumn) != "DEL" &amp;&amp; string_width(new_file_str) &lt; 64) {
    new_file_str += keyboard_get_key(row,coloumn);
    } else if(global.action_pressed &amp;&amp; keyboard_get_key(row,coloumn) = "DEL") {
    new_file_str = string_copy(new_file_str,0,string_length(new_file_str)-1);
    }
    
    if(global.start_pressed &amp;&amp; up = 320 &amp;&amp; new_file_str != "" &amp;&amp; new_file_str != " ") {
        ds_map_replace(obj_manager.save_data,"name",new_file_str)
        ds_map_replace(obj_manager.save_data,"pieces",0)
        ds_map_replace(obj_manager.save_data,"room",room_get_name(rm_giftplane))
        ds_map_replace(obj_manager.save_data,"lastfade",c_white)
        ds_map_replace(obj_manager.save_data,"lasttranstime",550)
        ds_map_replace(obj_manager.save_data,"lastfadespr",1)
        ds_map_replace(obj_manager.save_data,"fadeout",56)
        ds_map_replace(obj_manager.save_data,"prot",sprite_get_name(spr_player_down))
        ds_map_replace(obj_manager.save_data,"newfile",91.6/2)
        ds_map_replace(obj_manager.save_data,"panicsv",false)
        ds_map_replace(obj_manager.save_data,"x",8*32-1+24)
        ds_map_replace(obj_manager.save_data,"y",0)
        ds_map_replace(obj_manager.save_data,"z",0)
        if(fileselected = 0) {
        ds_map_replace(obj_manager.save_data,"saveto","file1.dat")
        ds_map_secure_save(obj_manager.save_data,"file1.dat");
        }
        if(fileselected = 1) {
        ds_map_replace(obj_manager.save_data,"saveto","file2.dat")
        ds_map_secure_save(obj_manager.save_data,"file2.dat");
        }
        if(fileselected = 2) {
        ds_map_replace(obj_manager.save_data,"saveto","file3.dat")
        ds_map_secure_save(obj_manager.save_data,"file3.dat");
        }
        audio_play_sound(snd_file_create_finish,10,false);
        stage = 0;
    }
    if(global.triangle_pressed &amp;&amp; up = 320) {
        stage = 0;
    }
} else {
num2--
}

if(num2 == 0) {
row = 0;
coloumn = 0;
select_x = 0;
select_y = 0;
new_file_str = ""
}

num2 = clamp(num2,0,20);
up = ease_inout_cubic(0,320,num2/20)
draw_sprite(spr_title_keyboard,0,0,-320+up);
draw_sprite_part(spr_title_keyboard,1,select_x+56,select_y+56,15,19,select_x+56,select_y-320+up+56);
draw_set_color(c_black)
draw_set_font(fnt_petscop);
draw_text(57, -320+up+28,"Name file: "+new_file_str);
//stage1/////////////////////////////////////////////////////

//stage2/////////////////////////////////////////////////////
if(stage = 2) {
    optionsin--;
    
    if(optionsup == 0) {
        if(global.up_pressed) opselected--;
        if(global.down_pressed) opselected++;
        opselected = clamp(opselected,0,1);
        
        if(fileselected = 0 &amp;&amp; opselected = 1 &amp;&amp; global.action_pressed) {
            if(file_exists("file1.dat")) {
            file_delete("file1.dat")
            audio_play_sound(snd_pause_secret_code,10,false);
            }
            stage = 0;
        }
         if(fileselected = 1 &amp;&amp; opselected = 1 &amp;&amp; global.action_pressed) {
            if(file_exists("file2.dat")) {
            file_delete("file2.dat")
            audio_play_sound(snd_pause_secret_code,10,false);
            }
            stage = 0;
        }
         if(fileselected = 2 &amp;&amp; opselected = 1 &amp;&amp; global.action_pressed) {
            if(file_exists("file3.dat")) {
            file_delete("file3.dat")
            audio_play_sound(snd_pause_secret_code,10,false);
            }
            stage = 0;
        }
        
        if(fileselected = 0 &amp;&amp; opselected = 0 &amp;&amp; global.action_pressed) {
            if(file_exists("file1.dat")) {
                with(obj_manager) {
                    ds_map_destroy(save_data);
                    save_data = ds_map_secure_load("file1.dat");
                    ds_map_replace(save_data,"saveto","file1.dat")
                }
                audio_play_sound(snd_press_start,10,false);
                stage = 20;
            } else {
                stage = 0;
            }
        }
        
         if(fileselected = 1 &amp;&amp; opselected = 0 &amp;&amp; global.action_pressed) {
            if(file_exists("file2.dat")) {
                with(obj_manager) {
                    ds_map_destroy(save_data);
                    save_data = ds_map_secure_load("file2.dat");  
                    ds_map_replace(save_data,"saveto","file2.dat")  
                }
                audio_play_sound(snd_press_start,10,false);
                stage = 20;
            } else {
                stage = 0;
            }
        }
        
         if(fileselected = 2 &amp;&amp; opselected = 0 &amp;&amp; global.action_pressed) {
            if(file_exists("file3.dat")) {
                with(obj_manager) {
                    ds_map_destroy(save_data);
                    save_data = ds_map_secure_load("file3.dat");
                    ds_map_replace(save_data,"saveto","file3.dat")
                }
                audio_play_sound(snd_press_start,10,false);
                stage = 20;
            } else {
                stage = 0;
            }
        }
        
        if(global.triangle_pressed) {
            stage = 0
        }
    }
} else {
    optionsin++;
}

if(optionsup == 160) {
    opselected = 0;
}
optionsin = clamp(optionsin,0,28)
optionsup = ease_inout_cubic(0,160,optionsin/28);
draw_sprite_ext(spr_fade,0,0,0,1,1,0,c_white,.5-optionsup/320);
draw_sprite(spr_title_options,opselected,0,-optionsup)
fileselected = clamp(fileselected,0,2);
//stage2/////////////////////////////////////////////////////

//stage 20///////////////////////////////////////////////////
if(stage = 20) {
optionsin = 0;
//load le file!

if(!instance_exists(obj_fade)) {
var transition = instance_create(x,y,obj_fade);
transition.fade_color = ds_map_find_value(obj_manager.save_data,"lastfade")
global.pieces = ds_map_find_value(obj_manager.save_data,"pieces")
transition.target_room = asset_get_index(ds_map_find_value(obj_manager.save_data,"room"));
transition.transition_time = ds_map_find_value(obj_manager.save_data,"lasttranstime")
transition.fade_spr = ds_map_find_value(obj_manager.save_data,"lastfadespr")
transition.fadein = 56;
transition.fadeout = ds_map_find_value(obj_manager.save_data,"fadeout");
obj_player_rpg.fadedir = asset_get_index(ds_map_find_value(obj_manager.save_data,"prot"));
obj_player_rpg.rot = asset_get_index(ds_map_find_value(obj_manager.save_data,"prot"));
obj_player_rpg.doorsteps = false;
obj_player_rpg.cam_x = ds_map_find_value(obj_manager.save_data,"newfile");
obj_player_rpg.player_x = ds_map_find_value(obj_manager.save_data,"x");
obj_player_rpg.player_y =ds_map_find_value(obj_manager.save_data,"y");
obj_player_rpg.player_z =ds_map_find_value(obj_manager.save_data,"z");
global.nmp = ds_map_find_value(obj_manager.save_data,"panicsv");
global.secretdoor = ds_map_find_value(obj_manager.save_data,"trapdoor");
global.pieces = ds_map_find_value(obj_manager.save_data,"pieces")
ds_map_secure_save(obj_manager.save_data,"demodat.dat");
}
}
//for(i = 0; i &lt; ds_map_size(obj_manager.save_data); i++) {

//}
/*test = string_replace_all(json_encode(obj_manager.save_data),",","#")
draw_set_color(c_black)
draw_text(0, 0, test);
/*draw_text(0,20,fscore2);
draw_text(0,40,fscore3);
draw_set_font(fnt_petscop);
draw_text(0,60,"uy:" + string(round(uy)));
draw_text(0,80,"ux:" + string(round(ux)));
draw_set_color(c_white)
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
